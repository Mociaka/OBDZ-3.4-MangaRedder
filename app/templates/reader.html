{% extends 'base.html' %}

{% block title %}{{ chapter.manga.title }} - –†–æ–∑–¥—ñ–ª {{ chapter.chapter_number }}{% endblock %}

{% block content %}
<div class="reader-container">
    <div class="reader-header">
        <a href="{{ url_for('manga_detail', manga_id=chapter.manga_id) }}" class="back-button">‚Üê –ù–∞–∑–∞–¥ –¥–æ {{
            chapter.manga.title }}</a>
        <h2 class="reader-title">–†–æ–∑–¥—ñ–ª {{ chapter.chapter_number }}{% if chapter.title %} - {{ chapter.title }}{% endif
            %}</h2>
    </div>

    <div class="reader-navigation">
        {% if prev_chapter %}
        <a href="{{ url_for('reader', chapter_id=prev_chapter.id) }}" class="nav-button prev-button">
            ‚Üê –ü–æ–ø–µ—Ä–µ–¥–Ω—ñ–π —Ä–æ–∑–¥—ñ–ª
        </a>
        {% else %}
        <span class="nav-button disabled">‚Üê –ü–æ–ø–µ—Ä–µ–¥–Ω—ñ–π —Ä–æ–∑–¥—ñ–ª</span>
        {% endif %}

        <span class="chapter-info">–†–æ–∑–¥—ñ–ª {{ chapter.chapter_number }}</span>

        {% if next_chapter %}
        <a href="{{ url_for('reader', chapter_id=next_chapter.id) }}" class="nav-button next-button">
            –ù–∞—Å—Ç—É–ø–Ω–∏–π —Ä–æ–∑–¥—ñ–ª ‚Üí
        </a>
        {% else %}
        <span class="nav-button disabled">–ù–∞—Å—Ç—É–ø–Ω–∏–π —Ä–æ–∑–¥—ñ–ª ‚Üí</span>
        {% endif %}
    </div>

    <div class="reader-pages">
        {% if pages %}
        {% for page in pages %}
        <div class="page-container" data-page="{{ page.page_number }}">
            <img src="{{ page.image_url }}" alt="–°—Ç–æ—Ä—ñ–Ω–∫–∞ {{ page.page_number }}" class="page-image" loading="lazy">
            <div class="page-number">–°—Ç–æ—Ä—ñ–Ω–∫–∞ {{ page.page_number }}</div>
        </div>
        {% endfor %}
        {% else %}
        <div class="no-pages">
            <p>üòî –£ —Ü—å–æ–º—É —Ä–æ–∑–¥—ñ–ª—ñ –ø–æ–∫–∏ –Ω–µ–º–∞—î —Å—Ç–æ—Ä—ñ–Ω–æ–∫</p>
        </div>
        {% endif %}
    </div>

    <div class="reader-navigation bottom-nav">
        {% if prev_chapter %}
        <a href="{{ url_for('reader', chapter_id=prev_chapter.id) }}" class="nav-button prev-button">
            ‚Üê –ü–æ–ø–µ—Ä–µ–¥–Ω—ñ–π —Ä–æ–∑–¥—ñ–ª
        </a>
        {% else %}
        <span class="nav-button disabled">‚Üê –ü–æ–ø–µ—Ä–µ–¥–Ω—ñ–π —Ä–æ–∑–¥—ñ–ª</span>
        {% endif %}

        {% if next_chapter %}
        <a href="{{ url_for('reader', chapter_id=next_chapter.id) }}" class="nav-button next-button">
            –ù–∞—Å—Ç—É–ø–Ω–∏–π —Ä–æ–∑–¥—ñ–ª ‚Üí
        </a>
        {% else %}
        <span class="nav-button disabled">–ù–∞—Å—Ç—É–ø–Ω–∏–π —Ä–æ–∑–¥—ñ–ª ‚Üí</span>
        {% endif %}
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    // Smooth scroll to page on load if hash is present
    if (window.location.hash) {
        const pageNumber = window.location.hash.substring(1);
        const pageElement = document.querySelector(`[data-page="${pageNumber}"]`);
        if (pageElement) {
            setTimeout(() => {
                pageElement.scrollIntoView({ behavior: 'smooth' });
            }, 100);
        }
    }
</script>
{% endblock %}